---
title: "Assignment_4_Draft"
author: "Jon Hart & Wes Newbury"
date: "11/10/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.width = 13, fig.height = 10)
```

![](California-Spiny-Lobster.jpg){width=400px} 

**Figure 1.** California Spiny Lobster *(Credit: [Catalina Island Marine Institute](https://cimioutdoored.org/ca-spiny-lobster/))*

![](lobster_site_locations.PNG){width=500px}

**Figure 2.** The five sampling locations *(Credit: [EDI Data Portal](https://portal.edirepository.org/nis/mapbrowse?scope=knb-lter-sbc&identifier=77&revision=newest))*


```{r, include =FALSE}
# Attach packages

library(tidyverse)
library(janitor)
library(here)
```

```{r}
# Read in data and do some basic cleaning

lobster_abundance <- read_csv("lobster_abundance_sbc_lter.csv",
  na = "-99999") %>% 
  clean_names() 
  
```

## Part A

```{r}
# Wrangle data for lobster count per year/site

lobster_count_year <- lobster_abundance %>% 
  group_by(year, site) %>% 
  summarize(total_count_site = sum(count, na.rm = TRUE)) %>% 
  mutate(MPA = case_when(
    site %in% c("IVEE", "NAPL") ~ "Site within Marine Protected Area",
    site %in% c("AQUE", "MOHK", "CARP") ~ "Site outside Marine Protected Area")) %>%   mutate(site_name = case_when(
    site == "IVEE" ~ "4) Isla Vista",
    site == "NAPL" ~ "5) Naples",  
    site == "AQUE" ~ "1) Arroyo Quemado",
    site == "MOHK" ~ "3) Mohawk",
    site == "CARP" ~ "2) Carpenteria")) 
```



```{r}
# Graph annual lobster counts by site over time

ggplot(data = lobster_count_year, aes(x = year, 
                                      y = total_count_site)) +
  geom_line(aes(color = MPA), 
                size = 1.5,
                show.legend = TRUE) + 
  geom_point(size = 2) +
  scale_x_continuous(breaks = seq(2012, 2018, by = 1),
                     limits = c(2011.5, 2018.5),
                     expand = c(0,0)) +
  scale_y_continuous(breaks = seq(0, 900, by = 150),
                     expand = c(0,0),
                     limits = c(0, 1000)) +
  theme_bw() +
  facet_wrap(~site_name, 
             nrow = 2,
             scales= "free_x") +
  labs(x = "Year",
       y = "Lobster Count",
       title = "Lobster Counts by Kelp Forest Study Site",
       subtitle = "2012 - 2018",
       caption = "Insert caption here") +
  theme(axis.text.x = element_text(angle= 90, 
                                   hjust = 1)) +
  theme(panel.grid.major = element_line(size = 1)) +
  theme(legend.position = c(.85,.25)) +
  theme(legend.title = element_blank())
        

```

## Part B

